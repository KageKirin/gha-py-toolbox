name: INSTALL via Dotnet-Tool
description: >-
  Installs NuGet tool packages via dotnet.
  Requires .NET and dotnet command to be installed.

inputs:
  packages:
    description: >
      Packages to install.
      Expects a whitespace-separated list, so use YAML `>`, `>-`, `|` or `|-`.
    required: true
  sudo:
    description: >
      'sudo' or 'su -u user' when required.
      Default is empty.
    required: false
    default: ''

runs:
  using: composite
  steps:
  - id: dotnet-tool-install
    name: Install via DOTNET
    shell: python
    env:
      packages: ${{ inputs.packages }}
    run: |
      import os, sys

      packages = str(os.getenv("packages")).split()
      sudo = str(os.getenv("sudo"))

      install_cmd = ["dotnet", "install", "-g"]

      if sudo and len(sudo):
          install_cmd = sudo.split() + install_cmd

      err = 0
      for package in packages:
          command = " ".join(install_cmd + [package])
          print(command)
          err = os.system(command)
          assert err == 0

      exit(err)
